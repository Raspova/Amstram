{"version":3,"file":"_server.ts-Bi1a7Fq2.js","sources":["../../../.svelte-kit/adapter-node/entries/endpoints/checkout/_server.ts.js"],"sourcesContent":["import Stripe from \"stripe\";\nimport { p as private_env } from \"../../../chunks/hooks.server.js\";\nimport { c as contenu } from \"../../../chunks/contenu.js\";\nconst stripe = new Stripe(private_env.STRIPE_SECRET_KEY, {\n  apiVersion: \"2025-02-24.acacia\"\n});\nconst POST = async ({ request }) => {\n  const data = await request.json();\n  data.price;\n  const id = data.id;\n  let vehicleTypeIndex = -1;\n  for (const lang of Object.keys(contenu)) {\n    const types = contenu[lang].vehicleTypes;\n    if (types) {\n      vehicleTypeIndex = types.indexOf(data.vType);\n      if (vehicleTypeIndex !== -1) break;\n    }\n  }\n  if (vehicleTypeIndex > 3)\n    vehicleTypeIndex = 1;\n  const image = \"https://amstram.eu/service/\" + vehicleTypeIndex + \".png\";\n  const lineItems = [{\n    price_data: {\n      currency: \"EUR\",\n      product_data: {\n        name: \"Amstram - Prise en charge de v√©hicule sur mesure\",\n        images: [image]\n      },\n      unit_amount: data.price * 100\n    },\n    quantity: 1\n  }];\n  const session = await stripe.checkout.sessions.create({\n    line_items: lineItems,\n    shipping_address_collection: {\n      allowed_countries: [\"NO\"]\n    },\n    mode: \"payment\",\n    success_url: `https://amstram.eu/route/${id}`,\n    //cancel_url: `https://amstram.eu/cancel`,\n    cancel_url: `http://localhost:5173/cancel`,\n    phone_number_collection: {\n      enabled: true\n    }\n  });\n  console.log(session.status);\n  return new Response(\n    JSON.stringify({\n      url: session.url\n    }),\n    {\n      status: 200,\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    }\n  );\n};\nexport {\n  POST\n};\n"],"names":[],"mappings":";;;;AAGA,MAAM,MAAM,GAAG,IAAI,MAAM,CAAC,WAAW,CAAC,iBAAiB,EAAE;AACzD,EAAE,UAAU,EAAE;AACd,CAAC,CAAC;AACG,MAAC,IAAI,GAAG,OAAO,EAAE,OAAO,EAAE,KAAK;AACpC,EAAE,MAAM,IAAI,GAAG,MAAM,OAAO,CAAC,IAAI,EAAE;AACnC,EAAE,IAAI,CAAC,KAAK;AACZ,EAAE,MAAM,EAAE,GAAG,IAAI,CAAC,EAAE;AACpB,EAAE,IAAI,gBAAgB,GAAG,CAAC,CAAC;AAC3B,EAAE,KAAK,MAAM,IAAI,IAAI,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE;AAC3C,IAAI,MAAM,KAAK,GAAG,OAAO,CAAC,IAAI,CAAC,CAAC,YAAY;AAC5C,IAAI,IAAI,KAAK,EAAE;AACf,MAAM,gBAAgB,GAAG,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC;AAClD,MAAM,IAAI,gBAAgB,KAAK,CAAC,CAAC,EAAE;AACnC;AACA;AACA,EAAE,IAAI,gBAAgB,GAAG,CAAC;AAC1B,IAAI,gBAAgB,GAAG,CAAC;AACxB,EAAE,MAAM,KAAK,GAAG,6BAA6B,GAAG,gBAAgB,GAAG,MAAM;AACzE,EAAE,MAAM,SAAS,GAAG,CAAC;AACrB,IAAI,UAAU,EAAE;AAChB,MAAM,QAAQ,EAAE,KAAK;AACrB,MAAM,YAAY,EAAE;AACpB,QAAQ,IAAI,EAAE,kDAAkD;AAChE,QAAQ,MAAM,EAAE,CAAC,KAAK;AACtB,OAAO;AACP,MAAM,WAAW,EAAE,IAAI,CAAC,KAAK,GAAG;AAChC,KAAK;AACL,IAAI,QAAQ,EAAE;AACd,GAAG,CAAC;AACJ,EAAE,MAAM,OAAO,GAAG,MAAM,MAAM,CAAC,QAAQ,CAAC,QAAQ,CAAC,MAAM,CAAC;AACxD,IAAI,UAAU,EAAE,SAAS;AACzB,IAAI,2BAA2B,EAAE;AACjC,MAAM,iBAAiB,EAAE,CAAC,IAAI;AAC9B,KAAK;AACL,IAAI,IAAI,EAAE,SAAS;AACnB,IAAI,WAAW,EAAE,CAAC,yBAAyB,EAAE,EAAE,CAAC,CAAC;AACjD;AACA,IAAI,UAAU,EAAE,CAAC,4BAA4B,CAAC;AAC9C,IAAI,uBAAuB,EAAE;AAC7B,MAAM,OAAO,EAAE;AACf;AACA,GAAG,CAAC;AACJ,EAAE,OAAO,CAAC,GAAG,CAAC,OAAO,CAAC,MAAM,CAAC;AAC7B,EAAE,OAAO,IAAI,QAAQ;AACrB,IAAI,IAAI,CAAC,SAAS,CAAC;AACnB,MAAM,GAAG,EAAE,OAAO,CAAC;AACnB,KAAK,CAAC;AACN,IAAI;AACJ,MAAM,MAAM,EAAE,GAAG;AACjB,MAAM,OAAO,EAAE;AACf,QAAQ,cAAc,EAAE;AACxB;AACA;AACA,GAAG;AACH;;;;"}